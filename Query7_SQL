select
	supp_nation, //供货商国家
	cust_nation, //顾客国家
	l_year, sum(volume) as revenue //年度、年度的货运收入
from ( //子查询
	select
		n1.n_name as supp_nation,
		n2.n_name as cust_nation,
		extract(year from l_shipdate) as l_year,
		l_extendedprice * (1 - l_discount) as volume
	from
		supplier,lineitem,orders,customer,nation n1,nation n2 //六表连接
	where
		s_suppkey = l_suppkey
		and o_orderkey = l_orderkey
		and c_custkey = o_custkey
		and s_nationkey = n1.n_nationkey
		and c_nationkey = n2.n_nationkey
		and ( // NATION2和NATION1的值不同，表示查询的是跨国的货运情况
			(n1.n_name = '[NATION1]' and n2.n_name = '[NATION2]')
			or (n1.n_name = '[NATION2]' and n2.n_name = '[NATION1]')
		)
		and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;